(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[525],{6409:function(e,t,s){Promise.resolve().then(s.bind(s,8708))},8708:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return u}});var i=s(7437),r=s(2265),n=s(9501),a=s(1245),c=s(9376),l=s(7120),o=s(6410),d=s(5978),m=s(9064);function u(){let{user:e}=(0,a.a)(),t=(0,c.useRouter)(),[s,u]=(0,r.useState)(!1),{register:x,control:p,handleSubmit:h,watch:b,setValue:g,formState:{errors:j}}=(0,n.cI)({defaultValues:{title:"",description:"",passingPercentage:60,timeLimit:30,questions:[{id:crypto.randomUUID(),text:"",type:"multiple-choice",options:[{id:crypto.randomUUID(),text:"",isCorrect:!1},{id:crypto.randomUUID(),text:"",isCorrect:!1},{id:crypto.randomUUID(),text:"",isCorrect:!1},{id:crypto.randomUUID(),text:"",isCorrect:!1}]}],isPublished:!1}}),{fields:y,append:f,remove:N}=(0,n.Dq)({control:p,name:"questions"}),v=b("questions"),q=e=>{f({id:crypto.randomUUID(),text:"",type:e,options:"multiple-choice"===e?[{id:crypto.randomUUID(),text:"",isCorrect:!1},{id:crypto.randomUUID(),text:"",isCorrect:!1},{id:crypto.randomUUID(),text:"",isCorrect:!1},{id:crypto.randomUUID(),text:"",isCorrect:!1}]:[{id:crypto.randomUUID(),text:"True",isCorrect:!1},{id:crypto.randomUUID(),text:"False",isCorrect:!1}]})},U=(e,t)=>{let s=[...v[e].options];"multiple-choice"===v[e].type?s.forEach((e,i)=>{s[i]={...e,isCorrect:i===t}}):s.forEach((e,i)=>{s[i]={...e,isCorrect:i===t}}),g("questions.".concat(e,".options"),s)},C=async function(s){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e){m.ZP.error("You must be logged in to create a quiz");return}let r=s.questions.filter(e=>!e.options.some(e=>e.isCorrect));if(r.length>0){m.ZP.error("Question ".concat(s.questions.indexOf(r[0])+1," doesn't have a correct answer selected"));return}u(!0);try{let r={title:s.title,description:s.description,passingPercentage:s.passingPercentage,timeLimit:s.timeLimit,questions:s.questions,isPublished:!i,createdBy:e.uid,createdAt:(0,d.Bt)(),updatedAt:(0,d.Bt)(),questionCount:s.questions.length},n=await (0,d.ET)((0,d.hJ)(o.db,"quizzes"),r);m.ZP.success(i?"Quiz saved as draft":"Quiz published successfully"),t.push("/admin/quizzes/".concat(n.id))}catch(e){console.error("Error creating quiz:",e),m.ZP.error("Failed to create quiz")}finally{u(!1)}};return(0,i.jsx)(l.Z,{requireAdmin:!0,children:(0,i.jsxs)("div",{className:"px-4 py-6",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Create New Quiz"}),(0,i.jsxs)("form",{onSubmit:h(e=>C(e,!1)),children:[(0,i.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:[(0,i.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Quiz Details"}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"title",className:"form-label",children:"Quiz Title"}),(0,i.jsx)("input",{id:"title",type:"text",className:"input-field",placeholder:"Enter quiz title",...x("title",{required:"Title is required"})}),j.title&&(0,i.jsx)("p",{className:"text-red-500 text-xs mt-1",children:j.title.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"description",className:"form-label",children:"Description"}),(0,i.jsx)("textarea",{id:"description",rows:3,className:"input-field",placeholder:"Enter quiz description",...x("description",{required:"Description is required"})}),j.description&&(0,i.jsx)("p",{className:"text-red-500 text-xs mt-1",children:j.description.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"passingPercentage",className:"form-label",children:"Passing Percentage"}),(0,i.jsx)("input",{id:"passingPercentage",type:"number",min:"1",max:"100",className:"input-field",...x("passingPercentage",{required:"Passing percentage is required",min:{value:1,message:"Minimum passing percentage is 1%"},max:{value:100,message:"Maximum passing percentage is 100%"}})}),j.passingPercentage&&(0,i.jsx)("p",{className:"text-red-500 text-xs mt-1",children:j.passingPercentage.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"timeLimit",className:"form-label",children:"Time Limit (minutes)"}),(0,i.jsx)("input",{id:"timeLimit",type:"number",min:"1",className:"input-field",...x("timeLimit",{required:"Time limit is required",min:{value:1,message:"Minimum time limit is 1 minute"}})}),j.timeLimit&&(0,i.jsx)("p",{className:"text-red-500 text-xs mt-1",children:j.timeLimit.message})]})]})]}),(0,i.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,i.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Questions"}),(0,i.jsxs)("div",{className:"flex space-x-2",children:[(0,i.jsx)("button",{type:"button",onClick:()=>q("multiple-choice"),className:"btn-secondary text-sm",children:"Add Multiple Choice"}),(0,i.jsx)("button",{type:"button",onClick:()=>q("true-false"),className:"btn-secondary text-sm",children:"Add True/False"})]})]}),0===y.length?(0,i.jsx)("div",{className:"text-center py-8 text-gray-500",children:(0,i.jsx)("p",{children:"No questions added yet. Use the buttons above to add questions."})}):(0,i.jsx)("div",{className:"space-y-8",children:y.map((e,t)=>{var s,r,n,a;return(0,i.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,i.jsxs)("h3",{className:"font-medium",children:["Question ",t+1]}),(0,i.jsx)("button",{type:"button",onClick:()=>N(t),className:"text-red-600 hover:text-red-800 text-sm",children:"Remove"})]}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"form-label",children:"Question Text"}),(0,i.jsx)("textarea",{className:"input-field",rows:2,placeholder:"Enter your question",...x("questions.".concat(t,".text"),{required:"Question text is required"})}),(null===(r=j.questions)||void 0===r?void 0:null===(s=r[t])||void 0===s?void 0:s.text)&&(0,i.jsx)("p",{className:"text-red-500 text-xs mt-1",children:null===(a=j.questions[t])||void 0===a?void 0:null===(n=a.text)||void 0===n?void 0:n.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"form-label",children:"Options"}),(0,i.jsx)("p",{className:"text-sm text-gray-500 mb-2",children:"Select the correct answer by clicking the radio button."}),(0,i.jsx)("div",{className:"space-y-2",children:v[t].options.map((e,s)=>(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("input",{type:"radio",id:"question-".concat(t,"-option-").concat(s),name:"question-".concat(t,"-correct"),"aria-label":"Mark as correct answer for option ".concat(s+1),title:"Mark as correct answer",checked:e.isCorrect,onChange:()=>U(t,s),className:"h-4 w-4 text-primary-600 focus:ring-primary-500"}),(0,i.jsx)("input",{type:"text",className:"input-field flex-grow",placeholder:"Option ".concat(s+1),value:v[t].options[s].text,readOnly:"true-false"===v[t].type,...x("questions.".concat(t,".options.").concat(s,".text"),{required:"Option text is required"})})]},e.id))})]})]})]},e.id)})})]}),(0,i.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,i.jsx)("button",{type:"button",onClick:()=>C(b(),!0),disabled:s,className:"btn-secondary",children:"Save as Draft"}),(0,i.jsx)("button",{type:"submit",disabled:s,className:"btn-primary",children:s?"Publishing...":"Publish Quiz"})]})]})]})})}}},function(e){e.O(0,[853,139,978,448,64,501,120,971,117,744],function(){return e(e.s=6409)}),_N_E=e.O()}]);